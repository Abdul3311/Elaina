"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs_1 = require("fs");
const Pixiv_1 = require("./Pixiv");
const pixiv = new Pixiv_1.Pixiv();
(async () => {
    pixiv.staticLogin("","");
    let page = 1;
    let tag = "ファプタ";
    let out = "B:/Images/.Pixiv/Faputa/";
    let mode = "safe";
    let artworks = await pixiv.getIllustsByTag(tag, { page: 1, mode: mode });
    while (artworks.length > 0) {
        console.log("PAGE " + page);
        for (let art of artworks) {
            console.log("|-" + art.id + " (" + (artworks.indexOf(art) + 1) + " / " + artworks.length + ")");
            const illust = await pixiv.getIllustByArtwork(art);
            if (illust.pageCount > 1) {
                fs_1.mkdirSync(out + illust.illustID, { recursive: true });
            }
            for (let i in illust.urls) {
                console.log("|---|- Illust " + (+i + 1));
                fs_1.writeFileSync(out + (illust.pageCount > 1 ? illust.illustID + "/" : "") + illust.illustID + "-" + i + ".jpg", await pixiv.download(new URL(illust.urls[i].original)));
            }
        }
        page++;
        artworks = (await pixiv.getIllustsByTag(tag, { mode: mode, page: page }));
    }
})();
